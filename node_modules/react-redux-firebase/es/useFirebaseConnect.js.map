{"version":3,"sources":["../src/useFirebaseConnect.js"],"names":["createUseFirebaseConnect","dataOrFn","firebase","inputAsFunc","data","firebaseEvents","Error","dispatch"],"mappings":"gaAoBO,GAAMA,CAAAA,wBAAwB,CAAG,iBAAM,UAAAC,QAAQ,CAAI,IAClDC,CAAAA,QAAQ,CAAG,0BADuC,CAGlDC,WAAW,CAAG,0BAAeF,QAAf,CAHoC,CAKlDG,IAAI,CAAGD,WAAW,EALgC,CAOlDE,cAAc,CAAG,mBACrB,UAAM,CACJ,GAAI,CAACD,IAAL,CACE,MAAO,KAAP,CAEF,GAAI,sBAAQA,IAAR,CAAJ,CACE,KAAM,IAAIE,CAAAA,KAAJ,CAAU,qDAAV,CAAN,CAEF,MAAO,8BAAmB,CAACF,IAAD,CAAnB,CACR,CAToB,CAUrB,CAACA,IAAD,CAVqB,CAPiC,CAoBxD,qBACE,UAAM,CACJ,GAAa,IAAT,GAAAA,IAAJ,CAEE,MADA,uBAAYF,QAAZ,CAAsBA,QAAQ,CAACK,QAA/B,CAAyCF,cAAzC,CACA,CAAO,UAAM,CACX,yBAAcH,QAAd,CAAwBA,QAAQ,CAACK,QAAjC,CAA2CF,cAA3C,CACD,CAEJ,CARH,CASE,CAACD,IAAD,CATF,CAWD,CA/BuC,CAAjC,C,uEAsFQJ,wBAAwB,E","sourcesContent":["import { isArray } from 'lodash'\nimport { useMemo, useEffect } from 'react'\nimport { watchEvents, unWatchEvents } from './actions/query'\nimport { getEventsFromInput, createCallable } from './utils'\nimport useFirebase from './useFirebase'\n\n/**\n * @name createUseFirebaseConnect\n * @description Function that creates a hook that\n * automatically listens/unListens to provided firebase paths using\n * React's useEffect hooks.\n * **WARNING!!** This is an advanced feature, and should only be used when\n * needing to access a firebase instance created under a different store key.\n * @return {Function} - HOC that accepts a watchArray and wraps a component\n * @example <caption>Basic</caption>\n * // this.props.firebase set on App component as firebase object with helpers\n * import { createUseFirebaseConnect } from 'react-redux-firebase'\n * // create firebase connect that uses another redux store\n * const useFirebaseConnect = createUseFirebaseConnect()\n */\nexport const createUseFirebaseConnect = () => dataOrFn => {\n  const firebase = useFirebase()\n\n  const inputAsFunc = createCallable(dataOrFn)\n\n  const data = inputAsFunc()\n\n  const firebaseEvents = useMemo(\n    () => {\n      if (!data) {\n        return null\n      }\n      if (isArray(data)) {\n        throw new Error(\"Array isn't allowed inside useFirebaseConnect hook.\")\n      }\n      return getEventsFromInput([data])\n    },\n    [data]\n  )\n\n  useEffect(\n    () => {\n      if (data !== null) {\n        watchEvents(firebase, firebase.dispatch, firebaseEvents)\n        return () => {\n          unWatchEvents(firebase, firebase.dispatch, firebaseEvents)\n        }\n      }\n    },\n    [data]\n  )\n}\n\n/**\n/**\n * @name useFirebaseConnect\n * @description Hook that automatically listens/unListens\n * to provided firebase paths using React's useEffect hook.\n * **Note** Only single path is allowed per one hook\n * @param {Object|String} queriesConfig - Object or string for path to sync\n * from Firebase or null if hook doesn't need to sync.\n * Can also be a function that returns an object or a path string.\n * @example <caption>Ordered Data</caption>\n * import { compose } from 'redux'\n * import { connect } from 'react-redux'\n * import { firebaseUseConnect } from 'react-redux-firebase'\n *\n * const enhance = compose(\n *   connect((state) => ({\n *     todos: state.firebase.ordered.todos\n *   })\n * )\n * \n * // use enhnace to pass todos list as props.todos\n * const Todos = enhance(({ todos })) => {\n *   useFirebaseConnect('todos') // sync /todos from firebase into redux\n *   return (\n *     <div>\n *       {JSON.stringify(todos, null, 2)}\n *     </div>\n *   )\n * }\n * \n * export default enhance(Todos)\n * @example <caption>Data that depends on props</caption>\n * import { compose } from 'redux'\n * import { connect } from 'react-redux'\n * import { firebaseUseConnect, getVal } from 'react-redux-firebase'\n *\n * const enhance = compose(\n *   connect((state, props) => ({\n *     post: getVal(state.firebase.data, `posts/${props.postId}`),\n *   })\n * )\n *\n * const Post = ({ post, postId }) => {\n *   useFirebaseConnect(`posts/${postId}`) // sync /posts/postId from firebase into redux\n *   return (\n *     <div>\n *       {JSON.stringify(post, null, 2)}\n *     </div>\n *   )\n * }\n *\n * export default enhance(Post)\n */\nexport default createUseFirebaseConnect()\n"],"file":"useFirebaseConnect.js"}